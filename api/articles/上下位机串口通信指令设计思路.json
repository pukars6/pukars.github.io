{"title":"送餐机器人上下位机串口通信指令设计思路","uid":"7c184991642f897400143ba8e4701ae2","slug":"上下位机串口通信指令设计思路","date":"2024-06-25T15:42:46.000Z","updated":"2024-06-25T15:49:22.467Z","comments":true,"path":"api/articles/上下位机串口通信指令设计思路.json","keywords":null,"cover":"https://img2.baidu.com/it/u=393587424,2062617373&fm=253&fmt=auto&app=138&f=JPEG?w=874&h=500","content":"<h2 id=\"协议方\"><a href=\"#协议方\" class=\"headerlink\" title=\"协议方\"></a>协议方</h2><p>操控界面（app)<br>送餐机器人(bot)</p>\n<h2 id=\"指令格式-发送-响应\"><a href=\"#指令格式-发送-响应\" class=\"headerlink\" title=\"指令格式-发送&#x2F;响应\"></a>指令格式-发送&#x2F;响应</h2><p>采用seq与ack机制实现发送响应对应<br>根据type类型指令类型，判断是seq还是ack，</p>\n<p>指令格式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">order,type,seq/ack,content</span><br></pre></td></tr></table></figure>\n\n\n<table>\n<thead>\n<tr>\n<th></th>\n<th>order</th>\n<th>type</th>\n<th>seq&#x2F;ack</th>\n<th>content</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>发送指令</td>\n<td>指令id，详见指令表</td>\n<td>0</td>\n<td>指令序号seq，由发送方生成，范围0~999</td>\n<td>指令内容，无值为空</td>\n</tr>\n<tr>\n<td>响应指令</td>\n<td>指令id，详见指令表</td>\n<td>1</td>\n<td>响应指令序号ack,ack&#x3D;seq，范围0~999</td>\n<td>指令内容，无值为空</td>\n</tr>\n<tr>\n<td>在xx秒内没有收到发送队列中指令的响应指令，重新发送</td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<h2 id=\"指令表\"><a href=\"#指令表\" class=\"headerlink\" title=\"指令表\"></a>指令表</h2><table>\n<thead>\n<tr>\n<th>指令</th>\n<th>order</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>获取机器人网络状态</td>\n<td>1</td>\n<td>APP发送，BOT响应，APP向BOT定时轮询</td>\n</tr>\n<tr>\n<td>机器人配网</td>\n<td>2</td>\n<td>APP向BOT发送SSID与PWD，APP发送，BOT响应</td>\n</tr>\n<tr>\n<td>开始送餐</td>\n<td>3</td>\n<td>APP向BOT发送送餐指令，BOT发送响应指令，开始送餐</td>\n</tr>\n<tr>\n<td>返回送餐起始位（送餐结束）</td>\n<td>4</td>\n<td>APP向BOT发送返回指令，BOT发送响应指令，开始返回</td>\n</tr>\n<tr>\n<td>开始送水送药</td>\n<td>5</td>\n<td>APP向BOT发送指令，BOT发送响应指令，开始执行运送任务</td>\n</tr>\n<tr>\n<td>-</td>\n<td>-</td>\n<td>-</td>\n</tr>\n<tr>\n<td>发生火灾</td>\n<td>21</td>\n<td>BOT向APP发送告警指令，APP发送响应指令，弹窗告警</td>\n</tr>\n<tr>\n<td>老人跌倒</td>\n<td>22</td>\n<td>BOT向APP发送告警指令，APP发送响应指令，弹窗告警</td>\n</tr>\n<tr>\n<td>烟雾弥漫、燃气或煤气发生泄露</td>\n<td>23</td>\n<td>BOT向APP发送告警指令，APP发送响应指令，弹窗告警</td>\n</tr>\n<tr>\n<td>老人起夜</td>\n<td>24</td>\n<td>BOT向APP发送告警指令，APP发送响应指令，弹窗告警</td>\n</tr>\n<tr>\n<td>送餐完成（到达指定地）</td>\n<td>25</td>\n<td>BOT向APP发送到达指令，APP发送响应指令，在界面展示到达指定地状态</td>\n</tr>\n<tr>\n<td>返回完成（到达送餐起始位）</td>\n<td>26</td>\n<td>BOT向APP发送到达指令，APP发送响应指令，在界面展示返回起始地状态</td>\n</tr>\n</tbody></table>\n<h2 id=\"指令内容\"><a href=\"#指令内容\" class=\"headerlink\" title=\"指令内容\"></a>指令内容</h2><p>内容尽量精简，总指令尽量不超过64B，下列为指令中需要携带数据的具体形式</p>\n<h6 id=\"机器人配网指令\"><a href=\"#机器人配网指令\" class=\"headerlink\" title=\"机器人配网指令\"></a>机器人配网指令</h6><p>发送指令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssid,password // 若需要其他参数以逗号分隔添加</span><br><span class=\"line\">eg:WIFI_325ESD,12345678</span><br></pre></td></tr></table></figure>\n<p>响应指令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0/1/2/3</span><br><span class=\"line\">0:连接成功 1:连接失败 ，此处可能还有其他的情况，后续添加</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>完整的指令形式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">发送指令:2,0,3,WIFI_325ESD,12345678 //SSid：WIFI_325ESD，pwd:12345678</span><br><span class=\"line\">响应指令:2,1,3,0 // 连接成功</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"机器人网络状态指令\"><a href=\"#机器人网络状态指令\" class=\"headerlink\" title=\"机器人网络状态指令\"></a>机器人网络状态指令</h5><p>发送指令：无数据</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">响应指令</span><br><span class=\"line\">0/1/2/3</span><br><span class=\"line\">0:连接状态 1:未连接状态 ，此处可能还有其他的情况，后续添加</span><br></pre></td></tr></table></figure>\n\n<p>完整的指令形式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">发送指令:1,0,7</span><br><span class=\"line\">响应指令:1,1,7,0 or 1,1,7,1</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"开始送餐指令\"><a href=\"#开始送餐指令\" class=\"headerlink\" title=\"开始送餐指令\"></a>开始送餐指令</h5><p>响应指令：无数据</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">发送指令</span><br><span class=\"line\">1~座位号</span><br></pre></td></tr></table></figure>\n<p>完整的指令形式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">发送指令:3,0,9,5 送餐去5号位</span><br><span class=\"line\">响应指令:3,1,9  Bot收到指令，开始送餐</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"返回送餐起始位指令\"><a href=\"#返回送餐起始位指令\" class=\"headerlink\" title=\"返回送餐起始位指令\"></a>返回送餐起始位指令</h5><p>发送指令：无数据  返回起始位 这个起始位是哪  还不清楚 未定<br>响应指令：无数据<br>完整的指令形式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">发送指令:4,0,43 返回起始位 这个起始位是哪？ 还不清楚</span><br><span class=\"line\">响应指令:4,1,43  Bot收到指令，开始返回</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"开始送水送药指令\"><a href=\"#开始送水送药指令\" class=\"headerlink\" title=\"开始送水送药指令\"></a>开始送水送药指令</h5><p>发送指令：未定<br>响应指令：无数据<br>完整的指令形式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">发送指令:5,0,2,? 未定</span><br><span class=\"line\">响应指令:5,1,2  Bot收到指令，开始送水送药</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"火灾、跌倒、烟雾、起夜等告警指令\"><a href=\"#火灾、跌倒、烟雾、起夜等告警指令\" class=\"headerlink\" title=\"火灾、跌倒、烟雾、起夜等告警指令\"></a>火灾、跌倒、烟雾、起夜等告警指令</h5><p>发送指令：无数据<br>响应指令：无数据<br>完整的指令形式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">发送指令:指令ID,0,seq APP收到指令，界面展示</span><br><span class=\"line\">响应指令:指令ID,1,ack </span><br></pre></td></tr></table></figure>\n\n<h5 id=\"机器人到达指定地指令\"><a href=\"#机器人到达指定地指令\" class=\"headerlink\" title=\"机器人到达指定地指令\"></a>机器人到达指定地指令</h5><p>发送指令：指定地信息<br>响应指令：无数据<br>完整的指令形式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">发送指令:25,0,seq,3 机器人到达3号位后发送该指令</span><br><span class=\"line\">响应指令:25,1,ack APP收到指令，在页面同步状态，发送响应指令</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"机器人到达起始位指令\"><a href=\"#机器人到达起始位指令\" class=\"headerlink\" title=\"机器人到达起始位指令\"></a>机器人到达起始位指令</h5><p>发送指令：起始位信息 这个起始位是哪， 还不清楚 未定<br>响应指令：无数据<br>完整的指令形式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">发送指令:26,0,seq,? ?代表起始位信息</span><br><span class=\"line\">响应指令:26,1,ack APP收到指令，在页面同步机器人状态，发送响应指令</span><br></pre></td></tr></table></figure>\n","text":"协议方操控界面（app)送餐机器人(bot) 指令格式-发送/响应采用seq与ack机制实现发送响应对应根据type类型指令类型，判断是seq还是ack， 指令...","permalink":"/post/上下位机串口通信指令设计思路","photos":[],"count_time":{"symbolsCount":"1.8k","symbolsTime":"2 mins."},"categories":[{"name":"随笔","slug":"随笔","count":1,"path":"api/categories/随笔.json"}],"tags":[{"name":"串口通信","slug":"串口通信","count":2,"path":"api/tags/串口通信.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8D%8F%E8%AE%AE%E6%96%B9\"><span class=\"toc-text\">协议方</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%8C%87%E4%BB%A4%E6%A0%BC%E5%BC%8F-%E5%8F%91%E9%80%81-%E5%93%8D%E5%BA%94\"><span class=\"toc-text\">指令格式-发送&#x2F;响应</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%8C%87%E4%BB%A4%E8%A1%A8\"><span class=\"toc-text\">指令表</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%8C%87%E4%BB%A4%E5%86%85%E5%AE%B9\"><span class=\"toc-text\">指令内容</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#%E6%9C%BA%E5%99%A8%E4%BA%BA%E9%85%8D%E7%BD%91%E6%8C%87%E4%BB%A4\"><span class=\"toc-text\">机器人配网指令</span></a></li></ol></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%BD%91%E7%BB%9C%E7%8A%B6%E6%80%81%E6%8C%87%E4%BB%A4\"><span class=\"toc-text\">机器人网络状态指令</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%BC%80%E5%A7%8B%E9%80%81%E9%A4%90%E6%8C%87%E4%BB%A4\"><span class=\"toc-text\">开始送餐指令</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%BF%94%E5%9B%9E%E9%80%81%E9%A4%90%E8%B5%B7%E5%A7%8B%E4%BD%8D%E6%8C%87%E4%BB%A4\"><span class=\"toc-text\">返回送餐起始位指令</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%BC%80%E5%A7%8B%E9%80%81%E6%B0%B4%E9%80%81%E8%8D%AF%E6%8C%87%E4%BB%A4\"><span class=\"toc-text\">开始送水送药指令</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E7%81%AB%E7%81%BE%E3%80%81%E8%B7%8C%E5%80%92%E3%80%81%E7%83%9F%E9%9B%BE%E3%80%81%E8%B5%B7%E5%A4%9C%E7%AD%89%E5%91%8A%E8%AD%A6%E6%8C%87%E4%BB%A4\"><span class=\"toc-text\">火灾、跌倒、烟雾、起夜等告警指令</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%88%B0%E8%BE%BE%E6%8C%87%E5%AE%9A%E5%9C%B0%E6%8C%87%E4%BB%A4\"><span class=\"toc-text\">机器人到达指定地指令</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%88%B0%E8%BE%BE%E8%B5%B7%E5%A7%8B%E4%BD%8D%E6%8C%87%E4%BB%A4\"><span class=\"toc-text\">机器人到达起始位指令</span></a></li></ol></li></ol></li></ol></li></ol>","author":{"name":"PUKARS","slug":"blog-author","avatar":"https://pukars-imagehosting.oss-cn-nanjing.aliyuncs.com/images/githubblog_avatar.jpg","link":"/","description":"随时记录随想","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"计算机系统安全导论复习纲要","uid":"86f338e57dfdeeda1884681f8e5e15da","slug":"计算机系统安全导论复习纲要","date":"2024-06-25T15:51:39.000Z","updated":"2024-06-26T14:06:14.474Z","comments":true,"path":"api/articles/计算机系统安全导论复习纲要.json","keywords":null,"cover":"https://img2.baidu.com/it/u=2706619423,2498078802&fm=253&fmt=auto&app=138&f=JPEG","text":"《计算机系统安全导论》复习纲要 攻击示例中探索目标网站一系列信息如网络结构，服务器功能、端口等的一系列小工具的作用及试探的顺序？ 安全云存储涉及哪些关键技术 云...","permalink":"/post/计算机系统安全导论复习纲要","photos":[],"count_time":{"symbolsCount":542,"symbolsTime":"1 mins."},"categories":[{"name":"课内","slug":"课内","count":1,"path":"api/categories/课内.json"}],"tags":[{"name":"计算机系统安全导论","slug":"计算机系统安全导论","count":1,"path":"api/tags/计算机系统安全导论.json"}],"author":{"name":"PUKARS","slug":"blog-author","avatar":"https://pukars-imagehosting.oss-cn-nanjing.aliyuncs.com/images/githubblog_avatar.jpg","link":"/","description":"随时记录随想","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"Hello World","uid":"b9663f58f18133b35bfe243f3e916a80","slug":"hello-world","date":"2024-06-25T14:50:48.048Z","updated":"2024-06-25T14:50:48.048Z","comments":true,"path":"api/articles/hello-world.json","keywords":null,"cover":null,"text":"Welcome to Hexo! This is your very first post. Check documentation for more info...","permalink":"/post/hello-world","photos":[],"count_time":{"symbolsCount":444,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"PUKARS","slug":"blog-author","avatar":"https://pukars-imagehosting.oss-cn-nanjing.aliyuncs.com/images/githubblog_avatar.jpg","link":"/","description":"随时记录随想","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}